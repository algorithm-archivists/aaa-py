<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel=stylesheet href="/pygments.css" type="text/css">
    <link rel=stylesheet href="/styles/style.css" type="text/css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <title id="ttl"></title>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>
<body>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$']]}
        });
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script>
        var bjs = {"gitbook": "3.x.x", "plugins": ["fontsettings", "mathjax@https://github.com/algorithm-archivists/plugin-mathjax", "bibtex-cite", "wordcount", "api-language-selector@https://github.com/algorithm-archivists/gitbook-plugin-api-language-selector.git", "include-codeblock", "ga", "bulk-redirect", "prism", "-highlight"], "lunr": {"maxIndexSize": 1000000000}, "pluginsConfig": {"mathjax": {"version": "2.6.1"}, "include-codeblock": {"fixlang": true, "unindent": true}, "bulk-redirect": {"basepath": "/", "redirectsFile": "redirects.json"}, "ga": {"token": "UA-118252470-1"}, "prism": {"lang": {"asm-x64": "nasm"}, "ignore": ["emojicode", "text"], "css": ["prismjs/themes/prism-tomorrow.css"]}, "api-language-selector": {"languages": [{"lang": "jl", "name": "Julia", "default": true}, {"lang": "bash", "name": "Bash"}, {"lang": "cs", "name": "C#"}, {"lang": "cpp", "name": "C++"}, {"lang": "c", "name": "C"}, {"lang": "c8", "name": "chip-8"}, {"lang": "py", "name": "Python"}, {"lang": "js", "name": "JavaScript"}, {"lang": "scratch", "name": "Scratch"}, {"lang": "hs", "name": "Haskell"}, {"lang": "rs", "name": "Rust"}, {"lang": "ml", "name": "OCaml"}, {"lang": "java", "name": "Java"}, {"lang": "clj", "name": "Clojure"}, {"lang": "elm", "name": "Elm"}, {"lang": "LabVIEW", "name": "LabVIEW"}, {"lang": "d", "name": "D"}, {"lang": "go", "name": "Go"}, {"lang": "swift", "name": "Swift"}, {"lang": "racket", "name": "Racket"}, {"lang": "m", "name": "Matlab"}, {"lang": "r", "name": "R"}, {"lang": "ti83b", "name": "TI-83 Basic"}, {"lang": "lua", "name": "Lua"}, {"lang": "crystal", "name": "Crystal"}, {"lang": "php", "name": "PHP"}, {"lang": "lisp", "name": "Common Lisp"}, {"lang": "nim", "name": "Nim"}, {"lang": "asm-x64", "name": "X86-64 Assembly"}, {"lang": "f90", "name": "Fortran90"}, {"lang": "factor", "name": "Factor"}, {"lang": "ws", "name": "Whitespace"}, {"lang": "scala", "name": "Scala"}, {"lang": "emojic", "name": "Emojicode"}, {"lang": "lolcode", "name": "LOLCODE"}, {"lang": "piet", "name": "Piet"}, {"lang": "ss", "name": "Scheme"}, {"lang": "ps1", "name": "PowerShell"}, {"lang": "v", "name": "Vlang"}, {"lang": "coffee", "name": "CoffeeScript"}, {"lang": "kotlin", "name": "Kotlin"}]}}};		    
        var lang = "jl";
        var langs = {};
        var langNames = bjs.pluginsConfig["api-language-selector"].languages;
        var translations = {
            "python": "Python",
            "bf": "Brainfuck",
            "st": "Smalltalk",
            "ruby": "Ruby",
            "kotlin": "Kotlin",
            "bash": "Bash",
            "haskell": "Haskell",
            "matlab": "Matlab",
            "javascript": "JavaScript"
        };
	
        function initLangs () {
            var samples = document.getElementsByClassName("code-section");
            for (var a = 0; a < samples.length; a++) {
                var sample = samples[a];
                var children = sample.children;
                for (var b = 0; b < children.length; b++)  {
                    var element = children[b];
                    langs[element.className] = true;
                };
            };
	    langs = Object.keys(langs);
	    if (langs.length == 1) {
		lang = langs[0];
	    }
            langNames.forEach(function(element) { translations[element.lang] = element.name });
        }
        function reload() {
            var samples = document.getElementsByClassName("code-section");
            for (var a = 0; a < samples.length; a++) {
                var sample = samples[a];
                var children = sample.children;
                for (var b = 0; b < children.length; b++)  {
                    var element = children[b];
                    if (element.className == lang) {
                        element.style.display = 'block';
                    } else {
                        element.style.display = 'none';
                    }
                };
            };
        };
        window.onload = () => {
            initLangs();
            reload();
            document.getElementById("name").innerText = pages[index];
            document.getElementById("ttl").innerText = pages[index];
            initLs();
        };
        var index = 22;
        var pages = [];
	var lsed = false;
				
        function flipLs () {
            var ls = document.getElementById("ls");
            var ls2 = document.getElementById("ls2");
            if (lsed) {
                ls.style.display = 'none';
                ls2.style.display = 'none';
            } else {
                ls.style.display = 'block';
                ls2.style.display = 'block';
            }
            lsed = !lsed
        }

	var funcs = {};
        function initLs () {
            if (langs.length === 0) {
                document.getElementById("flipper").remove();
            } else {
                var h1 = 0;
                var h2 = 0;
                for (var i = 0; i < langs.length; i++) {
                    let language = langs[i];
		    console.log(language);
		    var elem = document.createElement("p");
                    funcs[language] = {}
                    funcs[language] = () => {
                        lang = language;
                        reload();
                    };
                    elem.innerHTML = "<a onclick='funcs[\"" + language + "\"]()' href='#' class=ls-link>" + translations[language] + "</a>";
                    if (i % 2) {
                        h2 += 1
                        document.getElementById("ls2").appendChild(elem);
                    } else {
                        h1 += 1
                        document.getElementById("ls").appendChild(elem);
                    }
                }
                if (h1 > h2) {
                    var elem = document.createElement("p");
                    elem.innerHTML = "&nbsp;";
                    document.getElementById("ls2").appendChild(elem);
                } else if (h2 > h1) {
                    var elem = document.createElement("p");
                    elem.innerHTML = "&nbsp;";
                    document.getElementById("ls").appendChild(elem);
                }
                document.getElementById("ls").style.display = "none";
                document.getElementById("ls2").style.display = "none";
            }
        }
        function toggleSidenav () {
            $("#sidebar").toggleClass("hide");
            $("#content").toggleClass("on-sidebar");
            $("#navbar").toggleClass("no-sidebar");
        }
    </script>
    <div class="sidebar-wrapper" id="sidebar">
        
            <p>
                
                <a name="Algorithm Archive"></a>
                <a href="/index.html#Algorithm Archive">Algorithm Archive</a>
                <script>pages[0] = "Algorithm Archive"</script>
            </p>
        
            <p>
                
                <a name="Introduction"></a>
                <a href="/contents/introduction/introduction.html#Introduction">Introduction</a>
                <script>pages[1] = "Introduction"</script>
            </p>
        
            <p>
                
                <a name="How To Contribute"></a>
                <a href="/contents/how_to_contribute/how_to_contribute.html#How To Contribute">How To Contribute</a>
                <script>pages[2] = "How To Contribute"</script>
            </p>
        
            <p>
                
                <a name="Plotting"></a>
                <a href="/contents/plotting/plotting.html#Plotting">Plotting</a>
                <script>pages[3] = "Plotting"</script>
            </p>
        
            <p>
                
                <a name="Data Structures"></a>
                <a href="/contents/data_structures/data_structures.html#Data Structures">Data Structures</a>
                <script>pages[4] = "Data Structures"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Stacks and Queues"></a>
                <a href="/contents/stacks_and_queues/stacks_and_queues.html#Stacks and Queues">Stacks and Queues</a>
                <script>pages[5] = "Stacks and Queues"</script>
            </p>
        
            <p>
                
                <a name="Mathematical Background"></a>
                <a href="/contents/mathematical_background/mathematical_background.html#Mathematical Background">Mathematical Background</a>
                <script>pages[6] = "Mathematical Background"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Complexity Notation"></a>
                <a href="/contents/notation/notation.html#Complexity Notation">Complexity Notation</a>
                <script>pages[7] = "Complexity Notation"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Bit Logic"></a>
                <a href="/contents/bitlogic/bitlogic.html#Bit Logic">Bit Logic</a>
                <script>pages[8] = "Bit Logic"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Taylor Series"></a>
                <a href="/contents/taylor_series_expansion/taylor_series_expansion.html#Taylor Series">Taylor Series</a>
                <script>pages[9] = "Taylor Series"</script>
            </p>
        
            <p>
                
                <a name="Sorting and Searching"></a>
                <a href="/contents/sorting_and_searching/sorting_and_searching.html#Sorting and Searching">Sorting and Searching</a>
                <script>pages[10] = "Sorting and Searching"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Bubble Sort"></a>
                <a href="/contents/bubble_sort/bubble_sort.html#Bubble Sort">Bubble Sort</a>
                <script>pages[11] = "Bubble Sort"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Bogo Sort"></a>
                <a href="/contents/bogo_sort/bogo_sort.html#Bogo Sort">Bogo Sort</a>
                <script>pages[12] = "Bogo Sort"</script>
            </p>
        
            <p>
                
                <a name="Tree Traversal"></a>
                <a href="/contents/tree_traversal/tree_traversal.html#Tree Traversal">Tree Traversal</a>
                <script>pages[13] = "Tree Traversal"</script>
            </p>
        
            <p>
                
                <a name="Euclidean Algorithm"></a>
                <a href="/contents/euclidean_algorithm/euclidean_algorithm.html#Euclidean Algorithm">Euclidean Algorithm</a>
                <script>pages[14] = "Euclidean Algorithm"</script>
            </p>
        
            <p>
                
                <a name="Monte Carlo"></a>
                <a href="/contents/monte_carlo_integration/monte_carlo_integration.html#Monte Carlo">Monte Carlo</a>
                <script>pages[15] = "Monte Carlo"</script>
            </p>
        
            <p>
                
                <a name="Matrix Methods"></a>
                <a href="/contents/matrix_methods/matrix_methods.html#Matrix Methods">Matrix Methods</a>
                <script>pages[16] = "Matrix Methods"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Gaussian Elimination"></a>
                <a href="/contents/gaussian_elimination/gaussian_elimination.html#Gaussian Elimination">Gaussian Elimination</a>
                <script>pages[17] = "Gaussian Elimination"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Thomas Algorithm"></a>
                <a href="/contents/thomas_algorithm/thomas_algorithm.html#Thomas Algorithm">Thomas Algorithm</a>
                <script>pages[18] = "Thomas Algorithm"</script>
            </p>
        
            <p>
                
                <a name="Computational Geometry"></a>
                <a href="/contents/computational_geometry/computational_geometry.html#Computational Geometry">Computational Geometry</a>
                <script>pages[19] = "Computational Geometry"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Gift Wrapping"></a>
                <a href="/contents/gift_wrapping/gift_wrapping.html#Gift Wrapping">Gift Wrapping</a>
                <script>pages[20] = "Gift Wrapping"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                    &nbsp;
                
                <a name="Jarvis March"></a>
                <a href="/contents/jarvis_march/jarvis_march.html#Jarvis March">Jarvis March</a>
                <script>pages[21] = "Jarvis March"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                    &nbsp;
                
                <a name="Graham Scan"></a>
                <a href="/contents/graham_scan/graham_scan.html#Graham Scan">Graham Scan</a>
                <script>pages[22] = "Graham Scan"</script>
            </p>
        
            <p>
                
                <a name="FFT"></a>
                <a href="/contents/cooley_tukey/cooley_tukey.html#FFT">FFT</a>
                <script>pages[23] = "FFT"</script>
            </p>
        
            <p>
                
                <a name="Decision Problems"></a>
                <a href="/contents/decision_problems/decision_problems.html#Decision Problems">Decision Problems</a>
                <script>pages[24] = "Decision Problems"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Stable Marriage Problem"></a>
                <a href="/contents/stable_marriage_problem/stable_marriage_problem.html#Stable Marriage Problem">Stable Marriage Problem</a>
                <script>pages[25] = "Stable Marriage Problem"</script>
            </p>
        
            <p>
                
                <a name="Differential Equation Solvers"></a>
                <a href="/contents/differential_equations/differential_equations.html#Differential Equation Solvers">Differential Equation Solvers</a>
                <script>pages[26] = "Differential Equation Solvers"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Forward Euler Method"></a>
                <a href="/contents/forward_euler_method/forward_euler_method.html#Forward Euler Method">Forward Euler Method</a>
                <script>pages[27] = "Forward Euler Method"</script>
            </p>
        
            <p>
                
                <a name="Physics Solvers"></a>
                <a href="/contents/physics_solvers/physics_solvers.html#Physics Solvers">Physics Solvers</a>
                <script>pages[28] = "Physics Solvers"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Verlet Integration"></a>
                <a href="/contents/verlet_integration/verlet_integration.html#Verlet Integration">Verlet Integration</a>
                <script>pages[29] = "Verlet Integration"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Quantum Systems"></a>
                <a href="/contents/quantum_systems/quantum_systems.html#Quantum Systems">Quantum Systems</a>
                <script>pages[30] = "Quantum Systems"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                    &nbsp;
                
                <a name="Split-Operator Method"></a>
                <a href="/contents/split-operator_method/split-operator_method.html#Split-Operator Method">Split-Operator Method</a>
                <script>pages[31] = "Split-Operator Method"</script>
            </p>
        
            <p>
                
                <a name="Data Compression"></a>
                <a href="/contents/data_compression/data_compression.html#Data Compression">Data Compression</a>
                <script>pages[32] = "Data Compression"</script>
            </p>
        
            <p>
                
                    &nbsp;
                
                <a name="Huffman Encoding"></a>
                <a href="/contents/huffman_encoding/huffman_encoding.html#Huffman Encoding">Huffman Encoding</a>
                <script>pages[33] = "Huffman Encoding"</script>
            </p>
        
            <p>
                
                <a name="Quantum Information"></a>
                <a href="/contents/quantum_information/quantum_information.html#Quantum Information">Quantum Information</a>
                <script>pages[34] = "Quantum Information"</script>
            </p>
        
        <hr>
    </div>
    <nav class="navbarrio" id=navbar>
        <ul class="navbarro">
            <li>
                <span onclick="toggleSidenav()">
                    <i class="fas fa-align-left"></i>
                </button>
            </li>
            <li>
                <span onclick="flipLs()" id=flipper>
                    <i class="fas fa-code"></i>
                    <div class=ls id=ls></div>
                    <div class=ls2 id=ls2></div>
                </span>
            </li>
            <li>
                <span id=name></span>
            </li>
        </ul>
    </nav>
    <div class="container-fluid on-sidebar" id="content">
        <h1>Graham Scan</h1>
<p>At around the same time of the <a href="../jarvis_march/jarvis_march.html">Jarvis March</a>, R. L. Graham was also developing an algorithm to find the convex hull of a random set of points <a href="#ref-1">[1]</a>.
Unlike the Jarvis March, which is an <script type='math/tex'>\mathcal{O}(nh)</script> operation, the Graham Scan is <script type='math/tex'>\mathcal{O}(n\log(n))</script>, where <script type='math/tex'>n</script> is the number of points and <script type='math/tex'>h</script> is the size for the hull.
This means that the complexity of the Graham Scan is not output-sensitive; moreover, there are some cases where the Jarvis March is more optimal, depending on the size of the hull and the number of points to wrap.</p>
<p>Rather than starting at the leftmost point like the Jarvis March, the Graham scan starts at the bottom.
We then sort the distribution of points based on the angle between the bottom-most point, the origin, and each other point.
After sorting, we go through point-by-point, searching for points that are on the convex hull and throwing out any other points.
We do this by looking for counter-clockwise rotations.
If an angle between three points turns inward, the shape is obviously not convex, so we can throw that result out.
We can find whether a rotation is counter-clockwise with trigonometric functions or by using a cross-product, like so:</p>
<div class=code-section>
<div class="jl">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">::</span><span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">::</span><span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">::</span><span class="n">Point</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
<span class="n">end</span>
</pre></div>

</div></p>
</div><div class="hs">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">ccw</span> <span class="p">::</span> <span class="n">Point</span> <span class="o">-&gt;</span> <span class="n">Point</span> <span class="o">-&gt;</span> <span class="n">Point</span> <span class="o">-&gt;</span> <span class="n">Double</span>
<span class="n">ccw</span> <span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">ya</span><span class="p">)</span> <span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span> <span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">xb</span> <span class="o">-</span> <span class="n">xa</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">yc</span> <span class="o">-</span> <span class="n">ya</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">yb</span> <span class="o">-</span> <span class="n">ya</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xc</span> <span class="o">-</span> <span class="n">xa</span><span class="p">)</span>
</pre></div>

</div></p>
</div><div class="c">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">ccw</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span> <span class="n">a</span><span class="p">,</span> <span class="n">struct</span> <span class="n">point</span> <span class="n">b</span><span class="p">,</span> <span class="n">struct</span> <span class="n">point</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div><div class="js">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div><div class="py">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">counter_clockwise</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Is the turn counter-clockwise?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">p3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div></p>
</div><div class="go">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">func</span> <span class="n">counterClockwise</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span> <span class="n">point</span><span class="p">)</span> <span class="nb">bool</span> <span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">p3</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p3</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div><div class="java">
<p><div class="codehilite">
<div class="highlight"><pre><span></span>    <span class="n">static</span> <span class="n">double</span> <span class="n">ccw</span><span class="p">(</span><span class="n">Point</span> <span class="n">a</span><span class="p">,</span> <span class="n">Point</span> <span class="n">b</span><span class="p">,</span> <span class="n">Point</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
</pre></div>

</div></p>
</div><div class="cpp">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="kt">double</span> <span class="nf">ccw</span><span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">,</span> <span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div>
</div>

<p>If the output of this function is 0, the points are collinear.
If the output is positive, then the points form a counter-clockwise "left" turn.
If the output is negative, then the points form a clockwise "right" turn.
We basically do not want clockwise rotations, because this means we are at an interior angle.</p>
<!---ADD FIGURE--->

<p>To save memory and expensive <code>append()</code> operations, we ultimately look for points that should be on the hull and swap them with the first elements in the array.
If there are <script type='math/tex'>M</script> elements on the hull, then the first <script type='math/tex'>M</script> elements in our output random distribution of points will be the hull.
In the end, the code should look something like this:</p>
<div class=code-section>
<div class="jl">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">graham_scan</span><span class="err">!</span><span class="p">(</span><span class="n">points</span><span class="p">::</span><span class="n">Vector</span><span class="p">{</span><span class="n">Point</span><span class="p">})</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="c1"># Place the lowest point at the start of the array</span>
    <span class="n">sort</span><span class="err">!</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="n">item</span> <span class="o">-&gt;</span> <span class="n">item</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># Sort all other points according to angle with that point</span>
    <span class="n">other_points</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">end</span><span class="p">],</span> <span class="n">by</span> <span class="o">=</span> <span class="n">item</span> <span class="o">-&gt;</span> <span class="n">atan</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                                                         <span class="n">item</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>

    <span class="c1"># Place points sorted by angle back into points vector</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">other_points</span><span class="p">)</span>
        <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">end</span>

    <span class="c1"># M will be the point on the hull</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">M</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">M</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="c1"># All points are collinear</span>
            <span class="n">elseif</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">N</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">else</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">end</span>
        <span class="n">end</span>

        <span class="c1"># ccw point found, updating hull and swapping points</span>
        <span class="n">M</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">M</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">end</span>

    <span class="k">return</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">M</span><span class="p">]</span>
<span class="n">end</span>
</pre></div>

</div></p>
</div><div class="hs">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">grahamScan</span> <span class="p">::</span> <span class="p">[</span><span class="n">Point</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">Point</span><span class="p">]</span>
<span class="n">grahamScan</span> <span class="p">[]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">grahamScan</span> <span class="n">pts</span> <span class="o">=</span> <span class="n">wrap</span> <span class="n">sortedPts</span> <span class="p">[</span><span class="n">p0</span><span class="p">]</span>
  <span class="n">where</span> <span class="n">p0</span><span class="err">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">=</span> <span class="n">minimumBy</span> <span class="p">(</span><span class="n">compare</span> <span class="sb">`on`</span> <span class="n">snd</span><span class="p">)</span> <span class="n">pts</span>
        <span class="n">sortedPts</span> <span class="o">=</span> <span class="n">sortOn</span> <span class="p">(</span>\<span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">atan2</span> <span class="p">(</span><span class="n">py</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="p">(</span><span class="n">px</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span> <span class="err">$</span> <span class="nb">filter</span> <span class="p">(</span><span class="o">/=</span><span class="n">p0</span><span class="p">)</span> <span class="n">pts</span>
        <span class="n">wrap</span> <span class="p">[]</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span>
        <span class="n">wrap</span> <span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="n">ss</span><span class="p">)</span> <span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">wrap</span> <span class="n">ss</span> <span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">]</span>
        <span class="n">wrap</span> <span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="n">ss</span><span class="p">)</span> <span class="p">(</span><span class="n">p1</span><span class="p">:</span><span class="n">p2</span><span class="p">:</span><span class="n">ps</span><span class="p">)</span>
          <span class="o">|</span> <span class="n">ccw</span> <span class="n">s</span> <span class="n">p1</span> <span class="n">p2</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">wrap</span> <span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="n">ss</span><span class="p">)</span> <span class="p">(</span><span class="n">p2</span><span class="p">:</span><span class="n">ps</span><span class="p">)</span>
          <span class="o">|</span> <span class="n">otherwise</span>       <span class="o">=</span> <span class="n">wrap</span> <span class="n">ss</span> <span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="n">p1</span><span class="p">:</span><span class="n">p2</span><span class="p">:</span><span class="n">ps</span><span class="p">)</span>
</pre></div>

</div></p>
</div><div class="c">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">size_t</span> <span class="n">graham_scan</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span> <span class="o">*</span><span class="n">points</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">qsort</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span><span class="p">),</span> <span class="n">cmp_points</span><span class="p">);</span>
    <span class="n">polar_angles_sort</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="p">);</span>

    <span class="n">struct</span> <span class="n">point</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
    <span class="n">memcpy</span><span class="p">(</span><span class="n">tmp_points</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span><span class="p">));</span>
    <span class="n">tmp_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">size</span><span class="p">];</span>

    <span class="n">size_t</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">tmp_points</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">m</span><span class="o">--</span><span class="p">;</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">i</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">m</span><span class="o">++</span><span class="p">;</span>
        <span class="n">struct</span> <span class="n">point</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">tmp_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">m</span><span class="p">];</span>
        <span class="n">tmp_points</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">memcpy</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">tmp_points</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span><span class="p">));</span>

    <span class="k">return</span> <span class="n">m</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div><div class="js">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">grahamScan</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="p">{</span>
  <span class="o">//</span> <span class="n">First</span><span class="p">,</span> <span class="n">sort</span> <span class="n">the</span> <span class="n">points</span> <span class="n">so</span> <span class="n">the</span> <span class="n">one</span> <span class="k">with</span> <span class="n">the</span> <span class="n">lowest</span> <span class="n">y</span><span class="o">-</span><span class="n">coordinate</span> <span class="n">comes</span> <span class="n">first</span> <span class="p">(</span><span class="n">the</span> <span class="n">pivot</span><span class="p">)</span>
  <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="n">points</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">));</span>
  <span class="n">const</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

  <span class="o">//</span> <span class="n">Then</span> <span class="n">sort</span> <span class="nb">all</span> <span class="n">remaining</span> <span class="n">points</span> <span class="n">based</span> <span class="n">on</span> <span class="n">the</span> <span class="n">angle</span> <span class="n">between</span> <span class="n">the</span> <span class="n">pivot</span> <span class="ow">and</span> <span class="n">itself</span>
  <span class="n">const</span> <span class="n">hull</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pivot</span><span class="p">)</span> <span class="o">-</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">pivot</span><span class="p">));</span>

  <span class="o">//</span> <span class="n">The</span> <span class="n">pivot</span> <span class="ow">is</span> <span class="n">always</span> <span class="n">on</span> <span class="n">the</span> <span class="n">hull</span>
  <span class="n">hull</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="n">pivot</span><span class="p">);</span>

  <span class="n">let</span> <span class="n">n</span> <span class="o">=</span> <span class="n">hull</span><span class="o">.</span><span class="n">length</span><span class="p">;</span>
  <span class="n">let</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">===</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">[</span><span class="n">hull</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">m</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">hull</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="n">hull</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div><div class="py">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">graham_scan</span><span class="p">(</span><span class="n">gift</span><span class="p">):</span>
    <span class="n">gift</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">gift</span><span class="p">))</span>  <span class="c1"># Remove duplicate points</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">gift</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># Must be in hull</span>
    <span class="n">gift</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">gift</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">point</span><span class="p">:</span> <span class="n">polar_angle</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">point</span><span class="p">))</span>
    <span class="n">hull</span> <span class="o">=</span> <span class="p">[</span><span class="n">start</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

    <span class="c1"># Remove points from hull that make the hull concave</span>
    <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">counter_clockwise</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">pt</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">hull</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">hull</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hull</span>
</pre></div>

</div></p>
</div><div class="go">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">func</span> <span class="n">grahamScan</span><span class="p">(</span><span class="n">points</span> <span class="p">[]</span><span class="n">point</span><span class="p">)</span> <span class="p">[]</span><span class="n">point</span> <span class="p">{</span>
	<span class="n">sort</span><span class="o">.</span><span class="n">Slice</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="nb">int</span><span class="p">)</span> <span class="nb">bool</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">points</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">points</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">||</span> <span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">points</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">&amp;&amp;</span> <span class="n">points</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">points</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
	<span class="p">})</span>

	<span class="n">start</span> <span class="p">:</span><span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">points</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

	<span class="n">sort</span><span class="o">.</span><span class="n">Slice</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="nb">int</span><span class="p">)</span> <span class="nb">bool</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">b</span><span class="p">])</span>
	<span class="p">})</span>

	<span class="n">hull</span> <span class="p">:</span><span class="o">=</span> <span class="p">[]</span><span class="n">point</span><span class="p">{</span><span class="n">start</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">p</span> <span class="p">:</span><span class="o">=</span> <span class="nb">range</span> <span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="p">{</span>
		<span class="k">for</span> <span class="err">!</span><span class="n">counterClockwise</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hull</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hull</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">hull</span> <span class="o">=</span> <span class="n">hull</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">hull</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		<span class="p">}</span>
		<span class="n">hull</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="n">hull</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">hull</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div><div class="java">
<p><div class="codehilite">
<div class="highlight"><pre><span></span>    <span class="n">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">grahamScan</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">gift</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">gift</span> <span class="o">=</span> <span class="n">gift</span><span class="o">.</span><span class="n">stream</span><span class="p">()</span>
                   <span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
                   <span class="o">.</span><span class="n">sorted</span><span class="p">(</span><span class="n">Comparator</span><span class="o">.</span><span class="n">comparingDouble</span><span class="p">(</span><span class="n">point</span> <span class="o">-&gt;</span> <span class="o">-</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                   <span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="o">.</span><span class="n">toList</span><span class="p">());</span>

        <span class="n">Point</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">gift</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

        <span class="o">//</span> <span class="n">Sort</span> <span class="n">the</span> <span class="n">remaining</span> <span class="n">Points</span> <span class="n">based</span> <span class="n">on</span> <span class="n">the</span> <span class="n">angle</span> <span class="n">between</span> <span class="n">the</span> <span class="n">pivot</span> <span class="ow">and</span> <span class="n">itself</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">hull</span> <span class="o">=</span> <span class="n">gift</span><span class="o">.</span><span class="n">subList</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">gift</span><span class="o">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">hull</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">Comparator</span><span class="o">.</span><span class="n">comparingDouble</span><span class="p">(</span><span class="n">point</span> <span class="o">-&gt;</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">pivot</span><span class="p">)));</span>

        <span class="o">//</span> <span class="n">The</span> <span class="n">pivot</span> <span class="ow">is</span> <span class="n">always</span> <span class="n">on</span> <span class="n">the</span> <span class="n">hull</span>
        <span class="n">hull</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pivot</span><span class="p">);</span>

        <span class="nb">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">hull</span><span class="o">.</span><span class="n">size</span><span class="p">();</span>
        <span class="nb">int</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">hull</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hull</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">hull</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">m</span><span class="o">--</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="n">i</span><span class="o">++</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">m</span><span class="o">++</span><span class="p">;</span>

            <span class="n">Point</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">hull</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">hull</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">hull</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="p">));</span>
            <span class="n">hull</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">temp</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">hull</span><span class="o">.</span><span class="n">subList</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
</pre></div>

</div></p>
</div><div class="cpp">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">graham_scan</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;&amp;</span> <span class="n">points</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// selecting lowest point as pivot</span>
  <span class="kt">size_t</span> <span class="n">low_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">points</span><span class="p">[</span><span class="n">low_index</span><span class="p">].</span><span class="n">y</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">low_index</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">low_index</span><span class="p">]);</span>
  <span class="n">point</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

  <span class="c1">// sorting points by polar angle</span>
  <span class="n">std</span><span class="o">::</span><span class="n">sort</span><span class="p">(</span>
      <span class="n">points</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
      <span class="n">points</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span>
      <span class="p">[</span><span class="o">&amp;</span><span class="n">pivot</span><span class="p">](</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">pa</span><span class="p">,</span> <span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">pb</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">polar_angle</span><span class="p">(</span><span class="n">pivot</span><span class="p">,</span> <span class="n">pa</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">polar_angle</span><span class="p">(</span><span class="n">pivot</span><span class="p">,</span> <span class="n">pb</span><span class="p">);</span>
      <span class="p">});</span>

  <span class="c1">// creating convex hull</span>
  <span class="kt">size_t</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m</span><span class="o">--</span><span class="p">;</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">m</span><span class="o">++</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">m</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span><span class="p">(</span><span class="n">points</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">points</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div>
</div>

<h3>Bibliography</h3>
<p><a name="ref-1" class=bib-link></a>[Person('Jarvis, Ray A')]: On the identification of the convex hull of a finite set of points in the plane, <i>Elsevier</i>, 1973</p>
<h2>Example Code</h2>
<div class=code-section>
<div class="jl">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">struct</span> <span class="n">Point</span>
    <span class="n">x</span><span class="p">::</span><span class="n">Float64</span>
    <span class="n">y</span><span class="p">::</span><span class="n">Float64</span>
<span class="n">end</span>

<span class="n">function</span> <span class="n">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">::</span><span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">::</span><span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">::</span><span class="n">Point</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
<span class="n">end</span>

<span class="n">function</span> <span class="n">graham_scan</span><span class="err">!</span><span class="p">(</span><span class="n">points</span><span class="p">::</span><span class="n">Vector</span><span class="p">{</span><span class="n">Point</span><span class="p">})</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="c1"># Place the lowest point at the start of the array</span>
    <span class="n">sort</span><span class="err">!</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="n">item</span> <span class="o">-&gt;</span> <span class="n">item</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># Sort all other points according to angle with that point</span>
    <span class="n">other_points</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">end</span><span class="p">],</span> <span class="n">by</span> <span class="o">=</span> <span class="n">item</span> <span class="o">-&gt;</span> <span class="n">atan</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                                                         <span class="n">item</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>

    <span class="c1"># Place points sorted by angle back into points vector</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">other_points</span><span class="p">)</span>
        <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">end</span>

    <span class="c1"># M will be the point on the hull</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">M</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">M</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="c1"># All points are collinear</span>
            <span class="n">elseif</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">N</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">else</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">end</span>
        <span class="n">end</span>

        <span class="c1"># ccw point found, updating hull and swapping points</span>
        <span class="n">M</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">M</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">end</span>

    <span class="k">return</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">M</span><span class="p">]</span>
<span class="n">end</span>

<span class="n">function</span> <span class="n">main</span><span class="p">()</span>
    <span class="c1"># This hull is just a simple test so we know what the output should be</span>
    <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">14</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span>
        <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">),</span>
        <span class="n">Point</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">hull</span> <span class="o">=</span> <span class="n">graham_scan</span><span class="err">!</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">println</span><span class="p">(</span><span class="n">hull</span><span class="p">)</span>
<span class="n">end</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>

</div></p>
</div><div class="hs">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">Data.List</span> <span class="p">(</span><span class="n">sortOn</span><span class="p">,</span> <span class="n">minimumBy</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">Data.Function</span> <span class="p">(</span><span class="n">on</span><span class="p">)</span>

<span class="nb">type</span> <span class="n">Point</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">,</span> <span class="n">Double</span><span class="p">)</span>

<span class="n">ccw</span> <span class="p">::</span> <span class="n">Point</span> <span class="o">-&gt;</span> <span class="n">Point</span> <span class="o">-&gt;</span> <span class="n">Point</span> <span class="o">-&gt;</span> <span class="n">Double</span>
<span class="n">ccw</span> <span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">ya</span><span class="p">)</span> <span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span> <span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">xb</span> <span class="o">-</span> <span class="n">xa</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">yc</span> <span class="o">-</span> <span class="n">ya</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">yb</span> <span class="o">-</span> <span class="n">ya</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xc</span> <span class="o">-</span> <span class="n">xa</span><span class="p">)</span>

<span class="n">grahamScan</span> <span class="p">::</span> <span class="p">[</span><span class="n">Point</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">Point</span><span class="p">]</span>
<span class="n">grahamScan</span> <span class="p">[]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">grahamScan</span> <span class="n">pts</span> <span class="o">=</span> <span class="n">wrap</span> <span class="n">sortedPts</span> <span class="p">[</span><span class="n">p0</span><span class="p">]</span>
  <span class="n">where</span> <span class="n">p0</span><span class="err">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">=</span> <span class="n">minimumBy</span> <span class="p">(</span><span class="n">compare</span> <span class="sb">`on`</span> <span class="n">snd</span><span class="p">)</span> <span class="n">pts</span>
        <span class="n">sortedPts</span> <span class="o">=</span> <span class="n">sortOn</span> <span class="p">(</span>\<span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">atan2</span> <span class="p">(</span><span class="n">py</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="p">(</span><span class="n">px</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span> <span class="err">$</span> <span class="nb">filter</span> <span class="p">(</span><span class="o">/=</span><span class="n">p0</span><span class="p">)</span> <span class="n">pts</span>
        <span class="n">wrap</span> <span class="p">[]</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span>
        <span class="n">wrap</span> <span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="n">ss</span><span class="p">)</span> <span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">wrap</span> <span class="n">ss</span> <span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">]</span>
        <span class="n">wrap</span> <span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="n">ss</span><span class="p">)</span> <span class="p">(</span><span class="n">p1</span><span class="p">:</span><span class="n">p2</span><span class="p">:</span><span class="n">ps</span><span class="p">)</span>
          <span class="o">|</span> <span class="n">ccw</span> <span class="n">s</span> <span class="n">p1</span> <span class="n">p2</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">wrap</span> <span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="n">ss</span><span class="p">)</span> <span class="p">(</span><span class="n">p2</span><span class="p">:</span><span class="n">ps</span><span class="p">)</span>
          <span class="o">|</span> <span class="n">otherwise</span>       <span class="o">=</span> <span class="n">wrap</span> <span class="n">ss</span> <span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="n">p1</span><span class="p">:</span><span class="n">p2</span><span class="p">:</span><span class="n">ps</span><span class="p">)</span>

<span class="n">main</span> <span class="o">=</span> <span class="n">do</span>
  <span class="o">--</span> <span class="n">We</span> <span class="n">build</span> <span class="n">the</span> <span class="nb">set</span> <span class="n">of</span> <span class="n">points</span> <span class="n">of</span> <span class="n">integer</span> <span class="n">coordinates</span> <span class="n">within</span> <span class="n">a</span> <span class="n">circle</span> <span class="n">of</span> <span class="n">radius</span> <span class="mi">5</span>
  <span class="n">let</span> <span class="n">pts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">|</span> <span class="n">x</span><span class="o">&lt;-</span><span class="p">[</span><span class="o">-</span><span class="mf">5.</span><span class="o">.</span><span class="mi">5</span><span class="p">],</span> <span class="n">y</span><span class="o">&lt;-</span><span class="p">[</span><span class="o">-</span><span class="mf">5.</span><span class="o">.</span><span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">&lt;=</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">]</span>
  <span class="o">--</span> <span class="n">And</span> <span class="n">extract</span> <span class="n">the</span> <span class="n">convex</span> <span class="n">hull</span>
  <span class="k">print</span> <span class="err">$</span> <span class="n">grahamScan</span> <span class="n">pts</span>
</pre></div>

</div></p>
</div><div class="c">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="c1">#include &lt;math.h&gt;</span>
<span class="c1">#include &lt;stddef.h&gt;</span>
<span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;stdlib.h&gt;</span>
<span class="c1">#include &lt;string.h&gt;</span>

<span class="n">struct</span> <span class="n">point</span> <span class="p">{</span>
    <span class="n">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
<span class="p">};</span>

<span class="nb">int</span> <span class="n">cmp_points</span><span class="p">(</span><span class="n">const</span> <span class="n">void</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">const</span> <span class="n">void</span> <span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">struct</span> <span class="n">point</span><span class="o">*</span> <span class="n">pa</span> <span class="o">=</span> <span class="p">(</span><span class="n">struct</span> <span class="n">point</span><span class="o">*</span><span class="p">)</span> <span class="n">a</span><span class="p">;</span>
    <span class="n">struct</span> <span class="n">point</span><span class="o">*</span> <span class="n">pb</span> <span class="o">=</span> <span class="p">(</span><span class="n">struct</span> <span class="n">point</span><span class="o">*</span><span class="p">)</span> <span class="n">b</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">pb</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pa</span><span class="o">-&gt;</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">pb</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">double</span> <span class="n">ccw</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span> <span class="n">a</span><span class="p">,</span> <span class="n">struct</span> <span class="n">point</span> <span class="n">b</span><span class="p">,</span> <span class="n">struct</span> <span class="n">point</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">double</span> <span class="n">polar_angle</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span> <span class="n">origin</span><span class="p">,</span> <span class="n">struct</span> <span class="n">point</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">origin</span><span class="o">.</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">void</span> <span class="n">polar_angles_sort</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span> <span class="o">*</span><span class="n">points</span><span class="p">,</span> <span class="n">struct</span> <span class="n">point</span> <span class="n">origin</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">double</span> <span class="n">pivot_angle</span> <span class="o">=</span> <span class="n">polar_angle</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]);</span>

    <span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nb">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">polar_angle</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">pivot_angle</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">i</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">polar_angle</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">pivot_angle</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">j</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">j</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">struct</span> <span class="n">point</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
        <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>

        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
        <span class="n">j</span><span class="o">--</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">polar_angles_sort</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="n">polar_angles_sort</span><span class="p">(</span><span class="n">points</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">size</span> <span class="o">-</span> <span class="n">i</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">size_t</span> <span class="n">graham_scan</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span> <span class="o">*</span><span class="n">points</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">qsort</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span><span class="p">),</span> <span class="n">cmp_points</span><span class="p">);</span>
    <span class="n">polar_angles_sort</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="p">);</span>

    <span class="n">struct</span> <span class="n">point</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
    <span class="n">memcpy</span><span class="p">(</span><span class="n">tmp_points</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span><span class="p">));</span>
    <span class="n">tmp_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">size</span><span class="p">];</span>

    <span class="n">size_t</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">tmp_points</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">m</span><span class="o">--</span><span class="p">;</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">i</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">m</span><span class="o">++</span><span class="p">;</span>
        <span class="n">struct</span> <span class="n">point</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">tmp_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_points</span><span class="p">[</span><span class="n">m</span><span class="p">];</span>
        <span class="n">tmp_points</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">memcpy</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">tmp_points</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">struct</span> <span class="n">point</span><span class="p">));</span>

    <span class="k">return</span> <span class="n">m</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">struct</span> <span class="n">point</span> <span class="n">points</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{{</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">},</span> <span class="p">{</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">},</span>
                             <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">},</span> <span class="p">{</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">},</span>
                             <span class="p">{</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">},</span> <span class="p">{</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">},</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">}};</span>
    <span class="n">size_t</span> <span class="n">num_initial_points</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>

    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Points:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_initial_points</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">%f</span><span class="s2">,</span><span class="si">%f</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">size_t</span> <span class="n">hull_size</span> <span class="o">=</span> <span class="n">graham_scan</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">num_initial_points</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Hull:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">hull_size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">%f</span><span class="s2">,</span><span class="si">%f</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div><div class="js">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">grahamScan</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="p">{</span>
  <span class="o">//</span> <span class="n">First</span><span class="p">,</span> <span class="n">sort</span> <span class="n">the</span> <span class="n">points</span> <span class="n">so</span> <span class="n">the</span> <span class="n">one</span> <span class="k">with</span> <span class="n">the</span> <span class="n">lowest</span> <span class="n">y</span><span class="o">-</span><span class="n">coordinate</span> <span class="n">comes</span> <span class="n">first</span> <span class="p">(</span><span class="n">the</span> <span class="n">pivot</span><span class="p">)</span>
  <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="n">points</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">));</span>
  <span class="n">const</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

  <span class="o">//</span> <span class="n">Then</span> <span class="n">sort</span> <span class="nb">all</span> <span class="n">remaining</span> <span class="n">points</span> <span class="n">based</span> <span class="n">on</span> <span class="n">the</span> <span class="n">angle</span> <span class="n">between</span> <span class="n">the</span> <span class="n">pivot</span> <span class="ow">and</span> <span class="n">itself</span>
  <span class="n">const</span> <span class="n">hull</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pivot</span><span class="p">)</span> <span class="o">-</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">pivot</span><span class="p">));</span>

  <span class="o">//</span> <span class="n">The</span> <span class="n">pivot</span> <span class="ow">is</span> <span class="n">always</span> <span class="n">on</span> <span class="n">the</span> <span class="n">hull</span>
  <span class="n">hull</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="n">pivot</span><span class="p">);</span>

  <span class="n">let</span> <span class="n">n</span> <span class="o">=</span> <span class="n">hull</span><span class="o">.</span><span class="n">length</span><span class="p">;</span>
  <span class="n">let</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">===</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">[</span><span class="n">hull</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">m</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">hull</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="n">hull</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">function</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">Math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">function</span> <span class="n">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">const</span> <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">2</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">7</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="mi">12</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">9</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">11</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">15</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="mi">8</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="mi">9</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="mi">7</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="mi">9</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">14</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">8</span> <span class="p">},</span>
<span class="p">];</span>

<span class="n">const</span> <span class="n">convexHull</span> <span class="o">=</span> <span class="n">grahamScan</span><span class="p">(</span><span class="n">points</span><span class="p">);</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;The points in the hull are:&quot;</span><span class="p">);</span>
<span class="n">convexHull</span><span class="o">.</span><span class="n">forEach</span><span class="p">(</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sb">`(${p.x}, ${p.y})`</span><span class="p">));</span>
</pre></div>

</div></p>
</div><div class="py">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">atan2</span>


<span class="k">def</span> <span class="nf">counter_clockwise</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Is the turn counter-clockwise?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">p3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">polar_angle</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find the polar angle of a point relative to a reference point&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">graham_scan</span><span class="p">(</span><span class="n">gift</span><span class="p">):</span>
    <span class="n">gift</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">gift</span><span class="p">))</span>  <span class="c1"># Remove duplicate points</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">gift</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># Must be in hull</span>
    <span class="n">gift</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">gift</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">point</span><span class="p">:</span> <span class="n">polar_angle</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">point</span><span class="p">))</span>
    <span class="n">hull</span> <span class="o">=</span> <span class="p">[</span><span class="n">start</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

    <span class="c1"># Remove points from hull that make the hull concave</span>
    <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">counter_clockwise</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">pt</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">hull</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">hull</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hull</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">test_gift</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">hull</span> <span class="o">=</span> <span class="n">graham_scan</span><span class="p">(</span><span class="n">test_gift</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;The points in the hull are:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">hull</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>


<span class="n">main</span><span class="p">()</span>
</pre></div>

</div></p>
</div><div class="go">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s2">&quot;fmt&quot;</span>
	<span class="s2">&quot;math&quot;</span>
	<span class="s2">&quot;sort&quot;</span>
<span class="p">)</span>

<span class="nb">type</span> <span class="n">point</span> <span class="n">struct</span> <span class="p">{</span>
	<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="nb">int</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">counterClockwise</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span> <span class="n">point</span><span class="p">)</span> <span class="nb">bool</span> <span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">p3</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p3</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">point</span> <span class="n">point</span><span class="p">)</span> <span class="n">float64</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">Atan2</span><span class="p">(</span><span class="n">float64</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">ref</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">float64</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">ref</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">grahamScan</span><span class="p">(</span><span class="n">points</span> <span class="p">[]</span><span class="n">point</span><span class="p">)</span> <span class="p">[]</span><span class="n">point</span> <span class="p">{</span>
	<span class="n">sort</span><span class="o">.</span><span class="n">Slice</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="nb">int</span><span class="p">)</span> <span class="nb">bool</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">points</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">points</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">||</span> <span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">points</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">&amp;&amp;</span> <span class="n">points</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">points</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
	<span class="p">})</span>

	<span class="n">start</span> <span class="p">:</span><span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">points</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

	<span class="n">sort</span><span class="o">.</span><span class="n">Slice</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="nb">int</span><span class="p">)</span> <span class="nb">bool</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">b</span><span class="p">])</span>
	<span class="p">})</span>

	<span class="n">hull</span> <span class="p">:</span><span class="o">=</span> <span class="p">[]</span><span class="n">point</span><span class="p">{</span><span class="n">start</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">p</span> <span class="p">:</span><span class="o">=</span> <span class="nb">range</span> <span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="p">{</span>
		<span class="k">for</span> <span class="err">!</span><span class="n">counterClockwise</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hull</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hull</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">hull</span> <span class="o">=</span> <span class="n">hull</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">hull</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		<span class="p">}</span>
		<span class="n">hull</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="n">hull</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">hull</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">points</span> <span class="p">:</span><span class="o">=</span> <span class="p">[]</span><span class="n">point</span><span class="p">{{</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">},</span> <span class="p">{</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">},</span>
		<span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">},</span> <span class="p">{</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">},</span>
		<span class="p">{</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">},</span> <span class="p">{</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">},</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">}}</span>

	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s2">&quot;The points in the hull are:&quot;</span><span class="p">)</span>
	<span class="n">hull</span> <span class="p">:</span><span class="o">=</span> <span class="n">grahamScan</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">p</span> <span class="p">:</span><span class="o">=</span> <span class="nb">range</span> <span class="n">hull</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div><div class="java">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Comparator</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.Collectors</span><span class="p">;</span>

<span class="n">public</span> <span class="k">class</span> <span class="nc">GrahamScan</span> <span class="p">{</span>

    <span class="n">static</span> <span class="k">class</span> <span class="nc">Point</span> <span class="p">{</span>
        <span class="n">public</span> <span class="n">double</span> <span class="n">x</span><span class="p">;</span>
        <span class="n">public</span> <span class="n">double</span> <span class="n">y</span><span class="p">;</span>

        <span class="n">public</span> <span class="n">Point</span><span class="p">(</span><span class="n">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">double</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">this</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
            <span class="n">this</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nd">@Override</span>
        <span class="n">public</span> <span class="n">boolean</span> <span class="n">equals</span><span class="p">(</span><span class="n">Object</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">o</span> <span class="o">==</span> <span class="n">null</span><span class="p">)</span> <span class="k">return</span> <span class="n">false</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">o</span> <span class="o">==</span> <span class="n">this</span><span class="p">)</span> <span class="k">return</span> <span class="n">true</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="err">!</span><span class="p">(</span><span class="n">o</span> <span class="n">instanceof</span> <span class="n">Point</span><span class="p">))</span> <span class="k">return</span> <span class="n">false</span><span class="p">;</span>
            <span class="n">Point</span> <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">Point</span><span class="p">)</span><span class="n">o</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">this</span><span class="o">.</span><span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">this</span><span class="o">.</span><span class="n">y</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">static</span> <span class="n">double</span> <span class="n">ccw</span><span class="p">(</span><span class="n">Point</span> <span class="n">a</span><span class="p">,</span> <span class="n">Point</span> <span class="n">b</span><span class="p">,</span> <span class="n">Point</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">static</span> <span class="n">double</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">Point</span> <span class="n">origin</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">Math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">origin</span><span class="o">.</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">grahamScan</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">gift</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">gift</span> <span class="o">=</span> <span class="n">gift</span><span class="o">.</span><span class="n">stream</span><span class="p">()</span>
                   <span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
                   <span class="o">.</span><span class="n">sorted</span><span class="p">(</span><span class="n">Comparator</span><span class="o">.</span><span class="n">comparingDouble</span><span class="p">(</span><span class="n">point</span> <span class="o">-&gt;</span> <span class="o">-</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                   <span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="o">.</span><span class="n">toList</span><span class="p">());</span>

        <span class="n">Point</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">gift</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

        <span class="o">//</span> <span class="n">Sort</span> <span class="n">the</span> <span class="n">remaining</span> <span class="n">Points</span> <span class="n">based</span> <span class="n">on</span> <span class="n">the</span> <span class="n">angle</span> <span class="n">between</span> <span class="n">the</span> <span class="n">pivot</span> <span class="ow">and</span> <span class="n">itself</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">hull</span> <span class="o">=</span> <span class="n">gift</span><span class="o">.</span><span class="n">subList</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">gift</span><span class="o">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">hull</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">Comparator</span><span class="o">.</span><span class="n">comparingDouble</span><span class="p">(</span><span class="n">point</span> <span class="o">-&gt;</span> <span class="n">polarAngle</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">pivot</span><span class="p">)));</span>

        <span class="o">//</span> <span class="n">The</span> <span class="n">pivot</span> <span class="ow">is</span> <span class="n">always</span> <span class="n">on</span> <span class="n">the</span> <span class="n">hull</span>
        <span class="n">hull</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pivot</span><span class="p">);</span>

        <span class="nb">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">hull</span><span class="o">.</span><span class="n">size</span><span class="p">();</span>
        <span class="nb">int</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">hull</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hull</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">hull</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">m</span><span class="o">--</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="n">i</span><span class="o">++</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">m</span><span class="o">++</span><span class="p">;</span>

            <span class="n">Point</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">hull</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">hull</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">hull</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="p">));</span>
            <span class="n">hull</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">temp</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">hull</span><span class="o">.</span><span class="n">subList</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">points</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>

        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">));</span>
        <span class="n">points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">));</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">convexHull</span> <span class="o">=</span> <span class="n">grahamScan</span><span class="p">(</span><span class="n">points</span><span class="p">);</span>

        <span class="n">convexHull</span><span class="o">.</span><span class="n">forEach</span><span class="p">(</span><span class="n">p</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">% 1.0f</span><span class="s2">, </span><span class="si">% 1.0f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div><div class="cpp">
<p><div class="codehilite">
<div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">point</span> <span class="p">{</span>
  <span class="kt">double</span> <span class="n">x</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">y</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">os</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;&amp;</span> <span class="n">points</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">p</span> <span class="p">:</span> <span class="n">points</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;(&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">os</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="n">ccw</span><span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">,</span> <span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="n">polar_angle</span><span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">origin</span><span class="p">,</span> <span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">atan2</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">origin</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">origin</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">graham_scan</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;&amp;</span> <span class="n">points</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// selecting lowest point as pivot</span>
  <span class="kt">size_t</span> <span class="n">low_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">points</span><span class="p">[</span><span class="n">low_index</span><span class="p">].</span><span class="n">y</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">low_index</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">low_index</span><span class="p">]);</span>
  <span class="n">point</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

  <span class="c1">// sorting points by polar angle</span>
  <span class="n">std</span><span class="o">::</span><span class="n">sort</span><span class="p">(</span>
      <span class="n">points</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
      <span class="n">points</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span>
      <span class="p">[</span><span class="o">&amp;</span><span class="n">pivot</span><span class="p">](</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">pa</span><span class="p">,</span> <span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">pb</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">polar_angle</span><span class="p">(</span><span class="n">pivot</span><span class="p">,</span> <span class="n">pa</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">polar_angle</span><span class="p">(</span><span class="n">pivot</span><span class="p">,</span> <span class="n">pb</span><span class="p">);</span>
      <span class="p">});</span>

  <span class="c1">// creating convex hull</span>
  <span class="kt">size_t</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m</span><span class="o">--</span><span class="p">;</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">m</span><span class="o">++</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">m</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span><span class="p">(</span><span class="n">points</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">points</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">points</span> <span class="o">=</span> <span class="p">{{</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">},</span>
                               <span class="p">{</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">},</span>
                               <span class="p">{</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">},</span>
                               <span class="p">{</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">},</span>
                               <span class="p">{</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">},</span>
                               <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">},</span>
                               <span class="p">{</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">},</span>
                               <span class="p">{</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">},</span>
                               <span class="p">{</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">},</span>
                               <span class="p">{</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">},</span>
                               <span class="p">{</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">},</span>
                               <span class="p">{</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">},</span>
                               <span class="p">{</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">},</span>
                               <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">},</span>
                               <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">}};</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;original points are as follows:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">points</span><span class="p">;</span>
  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">hull</span> <span class="o">=</span> <span class="n">graham_scan</span><span class="p">(</span><span class="n">points</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;points in hull are as follows:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">hull</span><span class="p">;</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

</div></p>
</div>
</div>

<script>
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>

<h2>License</h2>
<h5>Code Examples</h5>
<p>The code examples are licensed under the MIT license (found in <a href="https://github.com/algorithm-archivists/algorithm-archive/blob/master/LICENSE.md">LICENSE.md</a>).</p>
<h5>Text</h5>
<p>The text of this chapter was written by <a href="https://github.com/leios">James Schloss</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><p><img  class="center" src="../cc/CC-BY-SA_icon.svg" /></p></a></p>
<h5>Pull Requests</h5>
<p>After initial licensing (<a href="https://github.com/algorithm-archivists/algorithm-archive/pull/560">#560</a>), the following pull requests have modified the text or graphics of this chapter:
- none</p>
        <hr>
    </div>
</body>
</html>